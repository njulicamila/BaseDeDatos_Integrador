DROP DATABASE laboratorio;
CREATE DATABASE LABORATORIO;
USE LABORATORIO;

#CREACION DE TABLAS


CREATE TABLE FACTURAS (
LETRA CHAR, 
NUMERO INT, 
 CLIENTEID INT, 
 ARTICULOID INT, 
 FECHA DATE,
 MONTO DOUBLE,
 PRIMARY KEY(LETRA, NUMERO)
);

    
CREATE TABLE ARTICULOS (
ARTICULOID INT PRIMARY KEY,
 NOMBRE VARCHAR(50),
 PRECIO DOUBLE,
 STOCK INT);
 
 CREATE TABLE CLIENTES  (
CLIENTEID INT PRIMARY KEY,
 NOMBRE VARCHAR(25),
 APELLIDO VARCHAR(25),
 CUIT CHAR(16),
 DIRECCION VARCHAR(50),
 COMENTARIOS VARCHAR(50)
);

SHOW databases;
#SHOW tables;
DESC CLIENTES;

#ETAPA 1.2 ---------------------
ALTER TABLE FACTURAS
CHANGE CLIENTEID IDCLIENTE INT;

ALTER TABLE FACTURAS
CHANGE ARTICULOID IDARTCULO INT;

ALTER TABLE FACTURAS
MODIFY MONTO DOUBLE UNSIGNED;

ALTER TABLE ARTICULOS
CHANGE ARTICULOID IDARTICULO INT PRIMARY KEY;

ALTER TABLE ARTICULOS
MODIFY NOMBRE VARCHAR(75);

ALTER TABLE ARTICULOS
MODIFY PRECIO DOUBLE UNSIGNED NOT NULL;

ALTER TABLE ARTICULOS
MODIFY STOCK INT UNSIGNED NOT NULL;

ALTER TABLE CLIENTES
CHANGE CLIENTEID IDCLIENTE INT PRIMARY KEY;

ALTER TABLE CLIENTES
MODIFY NOMBRE VARCHAR(30) NOT NULL;

ALTER TABLE CLIENTES
MODIFY APELLIDO VARCHAR(35) NOT NULL;

ALTER TABLE CLIENTES
CHANGE COMENTARIOS OBSERVACIONES VARCHAR(50);

ALTER TABLE CLIENTES
MODIFY OBSERVACIONES VARCHAR(255);

#ETAPA 1.3-------------------------------------------

INSERT INTO FACTURAS
VALUES('A', 28, 14, 335,'2021-03-18', 1589.50),
('A', 39, 26, 157, '2021-04-12', 979.75),
('B', 8, 17, 95, '2021-04-25', 513.35),
('B', 12, 5, 411, '2021-05-03', 2385.70),
('B', 19, 50, 157, '2021-05-26', 979.75);

INSERT INTO ARTICULOS
VALUES(95, 'Webcam con Micrófono Plug & Play', 513.35, 39),
(157, 'Apple AirPods Pro', 979.75, 152),
(335, 'Lavasecarropas Automático Samsung', 1589.50, 12),
(411,'Gloria Trevi / Gloria / CD+DVD', 2385.70 ,2);

INSERT INTO CLIENTES
VALUES(5, 'SANTIAGO', 'GONZALEZ','23-24582359-9' , 'Uriburu 558 - 7A', 'VIP'),
(14,'GLORIA', 'FERNANDEZ' , '23-35965852-5','Constitución 323','GBA'),
(17, 'GONZALO', 'LOPEZ', '23-33587416-0', 'ARIAS 2624', 'GBA' ),
(26, 'CARLOS', 'GARCIA', '23-42321230-9', 'Pasteur 322 - 2C', 'VIP'),
(50, 'MICAELA', 'ALTIERI', '23-22885566-5', 'SANTAMARINA 1255', 'GBA');

#ETAPA 2.1 --------------------------

ALTER TABLE CLIENTES_NEPTUNO
MODIFY IDCLIENTE VARCHAR(5) PRIMARY KEY;

ALTER TABLE CLIENTES_NEPTUNO
MODIFY NOMBRECOMPANIA VARCHAR(100) NOT NULL;

ALTER TABLE CLIENTES_NEPTUNO
MODIFY PAIS VARCHAR(15) NOT NULL;

RENAME TABLE CLIENTES TO CONTACTOS;

ALTER TABLE CLIENTES
MODIFY COD_CLIENTE VARCHAR(7) PRIMARY KEY;

ALTER TABLE CLIENTES
MODIFY EMPRESA VARCHAR(100) NOT NULL;

ALTER TABLE CLIENTES
MODIFY CIUDAD VARCHAR(25) NOT NULL;

ALTER TABLE CLIENTES
MODIFY TELEFONO INT UNSIGNED;

ALTER TABLE CLIENTES
MODIFY RESPONSABLE VARCHAR(30);

ALTER TABLE PEDIDOS
MODIFY NUMERO_PEDIDO INT UNSIGNED PRIMARY KEY;

ALTER TABLE PEDIDOS
MODIFY CODIGO_CLIENTE VARCHAR(7) NOT NULL;

ALTER TABLE PEDIDOS
MODIFY FECHA_PEDIDO DATE NOT NULL;

ALTER TABLE PEDIDOS
MODIFY FORMA_PAGO ENUM('APLAZADO', 'CONTADO', 'TARJETA');

ALTER TABLE PEDIDOS
MODIFY ENVIADO ENUM('SI','NO');


ALTER TABLE PRODUCTOS
MODIFY COD_PRODUCTO INT UNSIGNED PRIMARY KEY;

ALTER TABLE PRODUCTOS
MODIFY SECCION VARCHAR(20) NOT NULL;

ALTER TABLE PRODUCTOS
MODIFY NOMBRE VARCHAR(40) NOT NULL;

ALTER TABLE PRODUCTOS
MODIFY IMPORTADO ENUM('VERDADERO', 'FALSO');

ALTER TABLE PRODUCTOS
MODIFY ORIGEN VARCHAR(25) NOT NULL;

ALTER TABLE PRODUCTOS
MODIFY DIA INT UNSIGNED NOT NULL,
MODIFY MES INT UNSIGNED NOT NULL,
MODIFY ANO INT UNSIGNED NOT NULL;


#ETAPA 2.2 --------------------------
-- IMPORTAR SCRIPS
#ETAPA 2.3 --------------------------

SELECT *
FROM CLIENTES_NEPTUNO;

SELECT NOMBRECOMPANIA, CIUDAD, PAIS
FROM CLIENTES_NEPTUNO;

SELECT NOMBRECOMPANIA, CIUDAD, PAIS
FROM CLIENTES_NEPTUNO
ORDER BY PAIS ASC;

SELECT NOMBRECOMPANIA, CIUDAD, PAIS
FROM CLIENTES_NEPTUNO
ORDER BY PAIS,CIUDAD ASC;

SELECT NOMBRECOMPANIA, CIUDAD, PAIS
FROM CLIENTES_NEPTUNO
ORDER BY PAIS,CIUDAD ASC LIMIT 10;

SELECT NOMBRECOMPANIA, CIUDAD, PAIS
FROM CLIENTES_NEPTUNO
ORDER BY PAIS,CIUDAD ASC LIMIT 11,4;

#ETAPA 2.4 --------------------------

SELECT *
FROM NACIMIENTOS
WHERE NACIONALIDAD = 'EXTRANJERA';

SELECT *
FROM NACIMIENTOS
WHERE EDAD_MADRE < 18
ORDER BY EDAD_MADRE ASC;

SELECT *
FROM NACIMIENTOS
WHERE EDAD_MADRE= EDAD_PADRE;

SELECT *
FROM NACIMIENTOS
WHERE EDAD_PADRE-EDAD_MADRE >= 40;

SELECT *
FROM CLIENTES_NEPTUNO
WHERE PAIS = 'ARGENTINA';

SELECT *
FROM CLIENTES_NEPTUNO
WHERE PAIS != 'ARGENTINA'
ORDER BY PAIS ASC;

SELECT *
FROM NACIMIENTOS
WHERE SEMANAS < 20
ORDER BY SEMANAS DESC;

SELECT *
FROM NACIMIENTOS
WHERE SEXO = 'FEMENINO' AND ESTADO_CIVIL_MADRE = 'SOLTERA' AND NACIONALIDAD = 'EXTRANJERA' AND EDAD_MADRE > 40;


SELECT *
FROM CLIENTES_NEPTUNO
WHERE PAIS = 'ARGENTINA' OR PAIS = 'BRASIL' OR PAIS = 'VENEZUELA'
ORDER BY PAIS,CIUDAD ;

SELECT *
FROM NACIMIENTOS
WHERE SEMANAS BETWEEN 20 AND 25
ORDER BY SEMANAS ASC;

SELECT *
FROM NACIMIENTOS
WHERE COMUNA IN (1101,3201,5605, 8108, 9204, 13120,15202)
ORDER BY COMUNA ASC;

SELECT * 
FROM CLIENTES_NEPTUNO 
WHERE IDCLIENTE LIKE 'C%';

SELECT * 
FROM CLIENTES_NEPTUNO 
WHERE CIUDAD LIKE 'B____';

SELECT *
FROM NACIMIENTOS
WHERE HIJOS_TOTAL > 10;

#ETAPA 3.1 --------------------------
#ETAPA 3.2 --------------------------

SELECT IDCLIENTE,NOMBRECOMPANIA, CONCAT(DIRECCION,"_",CIUDAD,"_", PAIS) AS UBICACION
FROM CLIENTES_NEPTUNO;

SELECT IDCLIENTE,NOMBRECOMPANIA, CONCAT_WS("_",DIRECCION,CIUDAD, PAIS) AS UBICACION
FROM CLIENTES_NEPTUNO;

SELECT IDCLIENTE,UPPER(NOMBRECOMPANIA) AS COMPANIA, CONCAT_WS("_",DIRECCION,CIUDAD, PAIS) AS UBICACION
FROM CLIENTES_NEPTUNO;

SELECT LOWER(IDCLIENTE) AS CODIGO,UPPER(NOMBRECOMPANIA) AS COMPANIA, CONCAT_WS("_",DIRECCION,CIUDAD, PAIS) AS UBICACION
FROM CLIENTES_NEPTUNO;

SELECT FECHA, LEFT(SEXO,1) AS SEXO , LEFT (TIPO_PARTO,1) AS TIPO_PARTO
FROM NACIMIENTOS;

SELECT * , UPPER(CONCAT(LEFT(CIUDAD,1),LEFT(PAIS,1),RIGHT(PAIS,2))) AS CODIGO
FROM CLIENTES_NEPTUNO;

SELECT SEXO,FECHA,TIPO_PARTO,ATENC_PART,LOCAL_PART, SUBSTRING(FECHA,4,2) AS MES 
FROM NACIMIENTOS
ORDER BY MES ASC;

SELECT SEXO,FECHA,TIPO_PARTO,
CASE WHEN NACIONALIDAD = 'CHILENA' THEN 'CIUDADANA'
ELSE 'EXTRANJERA'
END AS NACIONALIDAD
FROM NACIMIENTOS;

#ETAPA 3.3 --------------------------

SELECT *
FROM PEDIDOS_NEPTUNO
WHERE YEAR(FECHAPEDIDO) = 1998;

SELECT *
FROM PEDIDOS_NEPTUNO
WHERE MONTH(FECHAPEDIDO) BETWEEN 08 AND 09;

SELECT *
FROM PEDIDOS_NEPTUNO
WHERE DAY(FECHAPEDIDO) = 1;

SELECT * , DATEDIFF(CURDATE(), FECHAPEDIDO) AS 'DIAS TRANSCURRIDOS'
FROM PEDIDOS_NEPTUNO;

SELECT * , DATEDIFF(CURDATE(), FECHAPEDIDO) AS 'DIAS TRANSCURRIDOS' , DAYNAME(FECHAPEDIDO) AS DIA
FROM PEDIDOS_NEPTUNO;

SELECT * , DATEDIFF(CURDATE(), FECHAPEDIDO) AS 'DIAS TRANSCURRIDOS' , DAYNAME(FECHAPEDIDO) AS DIA , DAY(FECHAPEDIDO) AS 'DIA DEL AÑO'
FROM PEDIDOS_NEPTUNO;

SELECT * , DATEDIFF(CURDATE(), FECHAPEDIDO) AS 'DIAS TRANSCURRIDOS' , DAYNAME(FECHAPEDIDO) AS DIA , DAY(FECHAPEDIDO) AS 'DIA DEL AÑO', MONTHNAME(FECHAPEDIDO) AS 'MES'
FROM PEDIDOS_NEPTUNO;

SELECT * , DATEDIFF(CURDATE(), FECHAPEDIDO) AS 'DIAS TRANSCURRIDOS' , DAYNAME(FECHAPEDIDO) AS DIA , DAY(FECHAPEDIDO) AS 'DIA DEL AÑO', MONTHNAME(FECHAPEDIDO) AS 'MES' ,ADDDATE(FECHAPEDIDO,INTERVAL 30 DAY)  AS 'PRIMER VENCIMIENTO'
FROM PEDIDOS_NEPTUNO;

SELECT * , DATEDIFF(CURDATE(), FECHAPEDIDO) AS 'DIAS TRANSCURRIDOS' , DAYNAME(FECHAPEDIDO) AS DIA , DAY(FECHAPEDIDO) AS 'DIA DEL AÑO', MONTHNAME(FECHAPEDIDO) AS 'MES' ,ADDDATE(FECHAPEDIDO,INTERVAL 2 MONTH)  AS 'PRIMER VENCIMIENTO'
FROM PEDIDOS_NEPTUNO;


#ETAPA 3.4 --------------------------

SELECT * , ROUND(CARGO * 0.21,2) AS IVA
FROM PEDIDOS_NEPTUNO;

SELECT * , ROUND(CARGO * 0.21,2) AS IVA ,ROUND(CARGO * 1.21,2) AS NETO 
FROM PEDIDOS_NEPTUNO;

SELECT * , ROUND(CARGO * 0.21,2) AS IVA ,ROUND(CARGO * 1.21,2) AS NETO, FLOOR(CARGO * 1.21) AS 'REDONDEO A FAVOR CLIENTE'
FROM PEDIDOS_NEPTUNO;

SELECT * , ROUND(CARGO * 0.21,2) AS IVA ,ROUND(CARGO * 1.21,2) AS NETO, FLOOR(CARGO * 1.21) AS 'REDONDEO A FAVOR CLIENTE' , CEIL(CARGO * 1.21) AS 'REDONDEO A FAVOR EMPRESA'
FROM PEDIDOS_NEPTUNO;

#ETAPA 3.5 --------------------------

select count(*)
from PEDIDOS_NEPTUNO;

select TRANSPORTISTA,COUNT(*)
from PEDIDOS_NEPTUNO
WHERE TRANSPORTISTA = 'SPEEDY EXPRESS';

select EMPLEADO,COUNT(*)
from PEDIDOS_NEPTUNO
WHERE EMPLEADO LIKE 'C%'
GROUP BY EMPLEADO;

SELECT ROUND(AVG(CARGO),2) AS 'PRECIO PROMEDIO'
FROM PEDIDOS_NEPTUNO;

SELECT ROUND(AVG(CARGO),2) AS 'PRECIO PROMEDIO' , MIN(CARGO) AS 'PRECIO INFERIOR'
FROM PEDIDOS_NEPTUNO;

SELECT ROUND(AVG(CARGO),2) AS 'PRECIO PROMEDIO' , MAX(CARGO) AS 'PRECIO MAXIMO'
FROM PEDIDOS_NEPTUNO;

SELECT NOMBRECOMPANIA AS CATEGORIA , MAX(CARGO) AS 'PRECIO MAXIMO'
FROM PEDIDOS_NEPTUNO
GROUP BY CATEGORIA;

SELECT TRANSPORTISTA, COUNT(TRANSPORTISTA) AS ENTREGAS
FROM PEDIDOS_NEPTUNO
GROUP BY TRANSPORTISTA;

SELECT SEXO, COUNT(SEXO) AS NACIMIENTOS
FROM NACIMIENTOS
GROUP BY SEXO;

SELECT NOMBRECOMPANIA AS CLIENTE, ROUND(SUM(CARGO),2) AS 'GASTO TOTALES'
FROM PEDIDOS_NEPTUNO
GROUP BY NOMBRECOMPANIA;

SELECT SECCION , COUNT(SECCION) AS CANTIDAD
FROM PRODUCTOS
GROUP BY SECCION
ORDER BY CANTIDAD DESC;

SELECT YEAR(FECHAPEDIDO) AS ANO, MONTH(FECHAPEDIDO) AS MES , COUNT(NOMBRECOMPANIA) AS VENTAS
FROM PEDIDOS_NEPTUNO
GROUP BY MES
ORDER BY ANO,MES;

SELECT EMPLEADO , ROUND(SUM(CARGO),2) AS FACTURACION ,  ROUND(AVG(CARGO),2) AS PROMEDIO , MAX(CARGO) AS 'MEJOR VENTA', MIN(CARGO) AS 'PEOR VENTA' , COUNT(EMPLEADO) AS VENTAS
FROM PEDIDOS_NEPTUNO
GROUP BY EMPLEADO;



















